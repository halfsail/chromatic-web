<script>import { get } from "svelte/store";
import { beforeUpdate, onDestroy, tick } from "svelte";
import { setGroupContext } from "./group.js";
const flows = /* @__PURE__ */ new Set();
let updating = false;
const registerWithGroup = (el) => {
  flows.add(el);
  beforeUpdate(async () => {
    if (updating) return;
    updating = true;
    flows.forEach(async (flow) => {
      {
        const f = get(flow);
        if (!f || !f.created) return;
        f.willUpdate();
      }
      await tick();
      get(flow)?.didUpdate();
    });
    await tick();
    updating = false;
  });
  onDestroy(() => {
    flows.delete(el);
  });
};
setGroupContext({ register: registerWithGroup });
</script>

<slot />
